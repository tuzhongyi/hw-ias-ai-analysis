<div class="system-main-manager root-route">
  <ias-system-main-map
    [over]="map.over"
    [out]="map.out"
    [select]="map.select"
    [moveto]="map.moveto"
    (itemclick)="map.on.select($event)"
    (itemdblclick)="map.on.details($event)"
    [shops]="map.data.shop"
    [devices]="map.data.device"
    [alarms]="map.data.realtime"
    [samples]="map.data.sample"
    (alarmvideo)="alarm.on.video($event)"
    (alarmpicture)="picture.open($event)"
    [heatmapload]="map.heatmap.load"
    [shopdisplay]="map.display.shop"
    [devicedisplay]="map.display.device"
    [alarmdisplay]="map.display.alarm"
    [sampledisplay]="map.display.sample"
    [heatmapdisplay]="map.display.heatmap"
  ></ias-system-main-map>

  <div
    class="system-main-manager-heatmap-filter panel-map"
    *ngIf="panel.navigation.index == Navigation.heatmap"
  >
    <ias-system-main-map-heatmap-filter
      (loaded)="map.on.heatmap($event)"
    ></ias-system-main-map-heatmap-filter>
  </div>

  <div
    class="system-main-manager-card-list left"
    *ngIf="panel.navigation.index != Navigation.heatmap"
  >
    <div class="system-main-manager-card-item">
      <ias-system-main-card-statistic-number
        *ngIf="card.statistic.number.show"
        [load]="load"
      ></ias-system-main-card-statistic-number>
    </div>
    <div class="system-main-manager-card-item">
      <ias-system-main-card-shop-statistic
        *ngIf="card.shop.statistic.show"
        [load]="load"
      ></ias-system-main-card-shop-statistic>
      <ias-system-main-card-device-state
        *ngIf="card.device.state.show"
        [load]="load"
      ></ias-system-main-card-device-state>
    </div>
    <div class="system-main-manager-card-item">
      <ias-system-main-card-statistic-event
        *ngIf="card.statistic.pie.show"
        [load]="load"
      >
      </ias-system-main-card-statistic-event>
      <ias-system-main-card-statistic-event-shop
        *ngIf="card.shop.pie.show"
        [load]="load"
      >
      </ias-system-main-card-statistic-event-shop>
      <ias-system-main-card-event-realtime-statistic
        *ngIf="card.realtime.pie.show"
        [load]="load"
      ></ias-system-main-card-event-realtime-statistic>
      <ias-system-main-card-device-route-statistic
        *ngIf="card.device.route.show"
        [load]="load"
      >
      </ias-system-main-card-device-route-statistic>
    </div>
  </div>
  <div
    class="system-main-manager-card-list right"
    *ngIf="panel.navigation.index != Navigation.heatmap"
  >
    <div class="system-main-manager-card-item">
      <ias-system-main-card-statistic-number-division-list [load]="load">
      </ias-system-main-card-statistic-number-division-list>
    </div>
    <div class="system-main-manager-card-item">
      <ias-system-main-card-event-chart-line-realtime
        *ngIf="card.realtime.line.show"
        [load]="load"
      ></ias-system-main-card-event-chart-line-realtime>
      <ias-system-main-card-event-chart-line-shop
        *ngIf="card.shop.line.show"
        [load]="load"
      ></ias-system-main-card-event-chart-line-shop>
      <ias-system-main-card-event-chart-line-sample
        *ngIf="card.gpstask.line.show"
        [load]="load"
      >
      </ias-system-main-card-event-chart-line-sample>
    </div>
    <div class="system-main-manager-card-item">
      <ias-system-main-card-event-table
        [mode]="card.statistic.table.mode"
        [modeable]="card.statistic.table.modeable"
        [shops]="shop.data.record"
        [realtimes]="realtime.datas"
        [samples]="gps.task.datas"
        (position)="card.statistic.table.on.position($event)"
        (details)="card.statistic.table.on.details($event)"
      ></ias-system-main-card-event-table>
    </div>
  </div>
  <div class="system-main-manager-panel-list" *ngIf="panel.list.show">
    <ias-system-main-panel-shop-registration-table-manager
      [datas]="shop.data.registration"
      [(selected)]="shop.selected"
      (details)="table.on.details($event)"
      (position)="table.on.position($event)"
      (itemhover)="table.on.item.over($event)"
      (itemblur)="table.on.item.out($event)"
      (filter)="shop.search($event)"
      (close)="panel.button.list.clicked = false"
    ></ias-system-main-panel-shop-registration-table-manager>
  </div>
  <div
    class="system-main-manager-panel-details"
    [class.list]="panel.list.show"
    *ngIf="panel.details.show"
  >
    <ias-system-map-panel-details-shop-registration
      [data]="shop.selected"
      (picture)="panel.details.on.picture($event)"
      (close)="panel.details.show = false"
    ></ias-system-map-panel-details-shop-registration>
  </div>
  <div class="system-main-manager-navigation">
    <ias-system-main-map-navigation
      [index]="panel.navigation.index"
      (indexChange)="panel.navigation.change($event)"
    ></ias-system-main-map-navigation>
  </div>
</div>
<!--  ias-system-event-process-realtime  -->
<ias-window
  [Model]="window.details"
  *ngIf="window.details.show"
  [style]="window.details.style"
  [title]="window.details.title"
>
  <ias-system-event-process-realtime
    [data]="window.details.data"
    (close)="window.details.show = false"
    (picture)="picture.open($event)"
  ></ias-system-event-process-realtime>
</ias-window>
<!--  ias-system-event-process-realtime  -->

<!--  ias-system-event-manager-realtime  -->
<ias-window
  [Model]="window.record.realtime"
  *ngIf="window.record.realtime.show"
  [style]="window.record.realtime.style"
  [title]="window.record.realtime.title"
>
  <ias-system-event-manager-realtime
    [iswindow]="true"
    [mapable]="false"
    [type]="window.record.realtime.type"
    [duration]="window.record.realtime.duration"
  ></ias-system-event-manager-realtime>
</ias-window>
<!--  ias-system-event-manager-realtime  -->
<!--  ias-system-event-manager-shop  -->
<ias-window
  [Model]="window.record.shop"
  *ngIf="window.record.shop.show"
  [style]="window.record.shop.style"
  [title]="window.record.shop.title"
>
  <ias-system-event-manager-shop
    [iswindow]="true"
    [mapable]="false"
    [duration]="window.record.shop.duration"
  ></ias-system-event-manager-shop>
</ias-window>
<!--  ias-system-event-manager-shop  -->
<!--  ias-system-event-manager-analysis  -->
<ias-window
  [Model]="window.record.analysis"
  *ngIf="window.record.analysis.show"
  [style]="window.record.analysis.style"
  [title]="window.record.analysis.title"
>
  <ias-system-event-manager-analysis
    [iswindow]="true"
    [mapable]="false"
    [duration]="window.record.analysis.duration"
  ></ias-system-event-manager-analysis>
</ias-window>
<!--  ias-system-event-manager-analysis  -->
<!--  ias-system-task-manager  -->
<ias-window
  [Model]="window.task"
  *ngIf="window.task.show"
  [style]="window.task.style"
  [title]="window.task.title"
>
  <ias-system-task-manager
    [iswindow]="true"
    [tabable]="false"
    [finished]="true"
    [operable]="false"
    [duration]="window.task.duration"
  ></ias-system-task-manager>
</ias-window>
<!--  ias-system-task-manager  -->
<ias-window
  *ngIf="window.picture.show"
  [Model]="window.picture"
  [style]="window.picture.style"
  [title]="window.picture.title"
>
  <ias-picture-list
    [id]="window.picture.id"
    [polygon]="window.picture.polygon"
    [zoom]="window.picture.polygon.length > 0"
    [page]="window.picture.page"
    (pageChange)="window.picture.change($event)"
  ></ias-picture-list>
</ias-window>
<ias-window
  [Model]="window.video.record"
  *ngIf="window.video.record.show"
  [style]="window.video.record.style"
  [title]="window.video.record.title"
  [CloseButton]="false"
>
  <div ngProjectAs="window-head-operation" class="window-video-operation">
    <div class="forms">
      <div class="form-item">
        <div class="form-item-text">前后时长</div>
        <div class="form-item-value">
          <select
            [(ngModel)]="window.video.record.args.duration"
            (change)="window.video.record.change()"
          >
            <!-- <option [ngValue]="undefined">全部</option> -->
            <option [ngValue]="5">5秒</option>
            <option [ngValue]="10">10秒</option>
            <option [ngValue]="15">15秒</option>
            <option [ngValue]="30">30秒</option>
          </select>
        </div>
      </div>
      <div class="form-item">
        <div class="form-item-text">摄像机:</div>
        <div class="form-item-value">
          <hw-select
            [nullable]="true"
            [(selected)]="window.video.record.args.channel"
            (selectedChange)="window.video.record.change()"
          >
            <select [(ngModel)]="window.video.record.args.channel">
              <option
                *ngFor="let item of window.video.record.channels"
                [ngValue]="item.Value"
              >
                {{ item.Name }}
              </option>
            </select>
          </hw-select>
        </div>
      </div>
      <div class="form-item">
        <div class="button" (click)="window.video.record.show = false">
          <i class="howell-icon-Close"></i>
        </div>
      </div>
    </div>
  </div>
  <ias-system-event-video
    [data]="window.video.record.data"
    [args]="window.video.record.args"
  ></ias-system-event-video>
</ias-window>
<ias-window
  *ngIf="window.video.shop.show && window.video.shop.args"
  [Model]="window.video.shop"
  [style]="window.video.shop.style"
  [title]="window.video.shop.title"
  [CloseButton]="false"
>
  <div ngProjectAs="window-head-operation" class="window-video-operation">
    <div class="forms">
      <div class="form-item">
        <div class="form-item-text">前后时长</div>
        <div class="form-item-value">
          <select
            [(ngModel)]="window.video.shop.args.Duration"
            (change)="window.video.shop.change()"
          >
            <!-- <option [ngValue]="undefined">全部</option> -->
            <option [ngValue]="5">5秒</option>
            <option [ngValue]="10">10秒</option>
            <option [ngValue]="15">15秒</option>
            <option [ngValue]="30">30秒</option>
          </select>
        </div>
      </div>
      <div class="form-item">
        <div class="form-item-text">摄像机:</div>
        <div class="form-item-value">
          <select
            [(ngModel)]="window.video.shop.args.Channel"
            (change)="window.video.shop.change()"
          >
            <!-- <option [ngValue]="undefined">全部</option> -->
            <option
              *ngFor="let item of source.channels | async"
              [ngValue]="item.Value"
            >
              {{ item.Name }}
            </option>
          </select>
        </div>
      </div>
      <div class="form-item">
        <div class="button" (click)="window.video.shop.show = false">
          <i class="howell-icon-Close"></i>
        </div>
      </div>
    </div>
  </div>
  <ias-system-task-video
    [args]="window.video.shop.args"
  ></ias-system-task-video>
</ias-window>
